==============================================================================
           MANUAL SSD FIX INSTRUCTIONS (Run as Administrator)
==============================================================================

Copy and paste these commands into PowerShell as Administrator:

-------------------------------------------------------------------------------
1. ADD WINDOWS DEFENDER EXCLUSIONS (CRITICAL)
-------------------------------------------------------------------------------
Run PowerShell as Administrator, then:

Add-MpPreference -ExclusionPath "E:\LRBillingOnline"
Add-MpPreference -ExclusionPath "C:\Users\$env:USERNAME\AppData\Local\Programs"
Add-MpPreference -ExclusionPath "C:\Program Files\nodejs"

Write-Host "Defender exclusions added successfully" -ForegroundColor Green

-------------------------------------------------------------------------------
2. DISABLE SUPERFETCH (SysMain)
-------------------------------------------------------------------------------
Set-Service -Name "SysMain" -StartupType Disabled
Stop-Service -Name "SysMain" -Force
Write-Host "Superfetch disabled successfully" -ForegroundColor Green

-------------------------------------------------------------------------------
3. RESET WINDOWS SEARCH INDEX
-------------------------------------------------------------------------------
Stop-Service -Name "WSearch" -Force
Start-Sleep -Seconds 2
C:\Windows\System32\SearchIndexer.exe /Reset /portable
Start-Service -Name "WSearch"
Write-Host "Search index reset successfully" -ForegroundColor Green

-------------------------------------------------------------------------------
4. DISABLE BACKGROUND APPS
-------------------------------------------------------------------------------
Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications" -Name "GlobalUserDisabled" -Value 1 -Force
Write-Host "Background apps disabled" -ForegroundColor Green

-------------------------------------------------------------------------------
5. OPTIMIZE SSD DRIVES
-------------------------------------------------------------------------------
Get-Volume | Where-Object {$_.DriveType -eq 'Fixed' -and $_.FileSystemType -eq 'NTFS'} | ForEach-Object {
    if ($_.DriveLetter) {
        Optimize-Volume -DriveLetter $_.DriveLetter -ReTrim
        Write-Host "Optimized drive $($_.DriveLetter)" -ForegroundColor Green
    }
}

-------------------------------------------------------------------------------
6. CLEAN TEMP FILES
-------------------------------------------------------------------------------
Write-Host "Cleaning temp files..." -ForegroundColor Cyan
Get-ChildItem -Path $env:TEMP -Recurse -Force -ErrorAction SilentlyContinue | Where-Object {$_.LastWriteTime -lt (Get-Date).AddDays(-7)} | Remove-Item -Recurse -Force -ErrorAction SilentlyContinue
Get-ChildItem -Path "$env:LOCALAPPDATA\Temp" -Recurse -Force -ErrorAction SilentlyContinue | Where-Object {$_.LastWriteTime -lt (Get-Date).AddDays(-7)} | Remove-Item -Recurse -Force -ErrorAction SilentlyContinue
Write-Host "Temp files cleaned" -ForegroundColor Green

-------------------------------------------------------------------------------
7. CLEAR RECYCLE BIN
-------------------------------------------------------------------------------
Clear-RecycleBin -Force -ErrorAction SilentlyContinue
Write-Host "Recycle bin cleared" -ForegroundColor Green

-------------------------------------------------------------------------------
8. FREE UP C: DRIVE (Run in separate session if C:\ is low on space)
-------------------------------------------------------------------------------
Write-Host "Cleaning Windows Update files..." -ForegroundColor Cyan
DISM.exe /Online /Cleanup-Image /StartComponentCleanup /ResetBase
Write-Host "Windows Update cleanup complete" -ForegroundColor Green

Write-Host "Running Disk Cleanup..." -ForegroundColor Cyan
cleanmgr /verylowdisk
Write-Host "Disk cleanup launched" -ForegroundColor Green

-------------------------------------------------------------------------------
9. REDUCE PAGEFILE SIZE (Manual Steps)
-------------------------------------------------------------------------------
Currently your pagefile is 24GB - here's how to reduce it:

1. Right-click "This PC" → Properties
2. Click "Advanced system settings"
3. Under "Performance", click "Settings"
4. Click "Advanced" tab
5. Under "Virtual memory", click "Change"
6. Uncheck "Automatically manage paging file size"
7. Select your C: drive
8. Select "Custom size"
9. Set Initial: 8192 MB (8GB)
10. Set Maximum: 16384 MB (16GB)
11. Click "Set" then "OK"
12. Restart computer

-------------------------------------------------------------------------------
10. ADD PROJECT CLEANUP TO SCHEDULE
-------------------------------------------------------------------------------
Copy these to PowerShell:

schtasks /Create /TN "WeeklyProjectCleanup" /TR "cd E:\LRBillingOnline && npm run clean" /SC Weekly /D SUN /ST 02:00
Write-Host "Weekly cleanup scheduled for Sundays at 2 AM" -ForegroundColor Green

-------------------------------------------------------------------------------
FINAL STEPS
-------------------------------------------------------------------------------
1. Run ALL commands above as Administrator
2. Restart your computer
3. Monitor disk usage in Task Manager for 24 hours
4. Report back if still spiking above 50%

Expected improvement: 99% → 10-20% average disk usage

==============================================================================

