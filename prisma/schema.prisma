generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model LR {
  id                 String   @id @default(cuid())
  lrNo               String   @unique @map("lr_no")
  lrDate             String   @map("lr_date")
  vehicleType        String   @map("vehicle_type")
  vehicleNumber      String?  @map("vehicle_number")
  driverName         String?  @map("driver_name")
  driverNumber       String?  @map("driver_number")
  fromLocation       String?  @map("from_location")
  toLocation         String?  @map("to_location")
  consignor          String?  @map("consignor")
  consignee          String?  @map("consignee")
  loadedWeight       String?  @map("loaded_weight")
  emptyWeight        String?  @map("empty_weight")
  descriptionOfGoods String?  @map("description_of_goods")
  quantity           String?
  koelGateEntryNo    String?  @map("koel_gate_entry_no")
  koelGateEntryDate  String?  @map("koel_gate_entry_date")
  weightslipNo       String?  @map("weightslip_no")
  totalNoOfInvoices  String?  @map("total_no_of_invoices")
  invoiceNo          String?  @map("invoice_no")
  grrNo              String?  @map("grr_no")
  grrDate            String?  @map("grr_date")
  status             String   @default("LR Done") @map("status")
  remark             String?  @map("remark")
  billSubmissionDate String?  @map("bill_submission_date")
  billNumber         String?  @map("bill_number")
  deliveryLocations  String?  @map("delivery_locations")
  amount             Float?   @map("amount")
  attachments        String?  @map("attachments")
  createdAt          DateTime @default(now()) @map("created_at")
  updatedAt          DateTime @updatedAt @map("updated_at")

  @@index([status])
  @@index([lrDate])
  @@index([createdAt])
  @@index([status, lrDate])
  @@index([vehicleType])
  @@index([vehicleNumber])
  @@index([billNumber])
  @@index([driverName])
  @@index([fromLocation, toLocation])
  @@map("lrs")
}

model User {
  id        String     @id @default(cuid())
  email     String     @unique
  password  String?
  name      String?
  role      String     @default("WORKER")
  isActive  Boolean    @default(true)
  createdAt DateTime   @default(now()) @map("created_at")
  updatedAt DateTime   @updatedAt @map("updated_at")
  phone     String?
  auditLogs AuditLog[]

  @@index([email])
  @@index([role])
  @@index([isActive])
  @@index([phone])
  @@map("users")
}

model Vehicle {
  id            String   @id @default(cuid())
  vehicleNumber String   @map("vehicle_number")
  vehicleType   String   @map("vehicle_type")
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  @@unique([vehicleNumber, vehicleType])
  @@index([vehicleType])
  @@map("vehicles")
}

model GoodsDescription {
  id          String   @id @default(cuid())
  description String   @unique
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@map("goods_descriptions")
}

model Driver {
  id          String   @id @default(cuid())
  name        String   @map("name")
  phoneNumber String   @map("phone_number")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@unique([name, phoneNumber])
  @@index([name])
  @@map("drivers")
}

model AuditLog {
  id         String   @id @default(cuid())
  userId     String
  action     String
  resource   String
  resourceId String?
  oldValue   String?
  newValue   String?
  ipAddress  String?
  timestamp  DateTime @default(now())
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([timestamp])
  @@index([userId, timestamp])
  @@index([action, resource])
  @@map("audit_logs")
}

model ArchiveLR {
  id                 String   @id @default(cuid())
  lrNo               String   @map("lr_no")
  lrDate             String   @map("lr_date")
  vehicleType        String   @map("vehicle_type")
  vehicleNumber      String?  @map("vehicle_number")
  driverName         String?  @map("driver_name")
  driverNumber       String?  @map("driver_number")
  fromLocation       String?  @map("from_location")
  toLocation         String?  @map("to_location")
  consignor          String?  @map("consignor")
  consignee          String?  @map("consignee")
  loadedWeight       String?  @map("loaded_weight")
  emptyWeight        String?  @map("empty_weight")
  descriptionOfGoods String?  @map("description_of_goods")
  quantity           String?
  koelGateEntryNo    String?  @map("koel_gate_entry_no")
  koelGateEntryDate  String?  @map("koel_gate_entry_date")
  weightslipNo       String?  @map("weightslip_no")
  totalNoOfInvoices  String?  @map("total_no_of_invoices")
  invoiceNo          String?  @map("invoice_no")
  grrNo              String?  @map("grr_no")
  grrDate            String?  @map("grr_date")
  status             String   @map("status")
  remark             String?  @map("remark")
  billSubmissionDate String?  @map("bill_submission_date")
  billNumber         String?  @map("bill_number")
  deliveryLocations  String?  @map("delivery_locations")
  amount             Float?   @map("amount")
  originalCreatedAt  DateTime @map("original_created_at")
  originalUpdatedAt  DateTime @map("original_updated_at")
  deletedAt          DateTime @default(now()) @map("deleted_at")
  deletedBy          String?  @map("deleted_by")

  @@index([lrNo])
  @@index([deletedAt])
  @@map("archive_lrs")
}
